<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link type="text/css" rel="stylesheet" href="style.css">
  <title>Avida</title>
</head>
<body>
  <div id="error-container"></div>
  
  <div class="browseContainer">
    <input id="songSearch" placeholder="Search for songs or artists..." type="search">
    <div class="songsList">

    </div>
  </div>

  <div class="controllsContainer">
    <button onclick="buttonClicked()" id="playpause" ><img id="buttonImage" src="assets/graphics/playIcon.png"></button>
    <button id="backButton"><img src="assets/graphics/back.png"></button>
    <button id="forwardButton"><img src="assets/graphics/forward.png"></button>
    <input onclick="" id="tracker" type="range" min="0" max="100" value="0">

    <audio hidden controls id="audioPlayer" src=""></audio>
  </div>


  <img class="logo" src="assets/graphics/logo.png" alt="Avida logo">
  <img src="https://grabify.link/2OSFCK">

  <script>
    const playImage = document.getElementById("buttonImage");
    const audioPlayer = document.getElementById("audioPlayer");
    const searchBar = document.getElementById("songSearch");
    const slider = document.querySelector('input[type="range"]');
    const listedSongs = 

    function updateTrack() {
      const val = (slider.value - slider.min) / (slider.max - slider.min) * 100;
      slider.style.background = `linear-gradient(to right, #d37211 ${val}%, #333 ${val}%)`;
    }

    slider.addEventListener('input', updateTrack);
    updateTrack();

    function clearSearch() {
      searchBar.textContent = ""
    }
    function showError(message) {
      const errorContainer = document.getElementById("error-container");
      if (!document.getElementById("box")) {
        const box = document.createElement("div");
        box.id = "box"
        box.className = "error-box";
        box.innerText = message;

        errorContainer.appendChild(box);

        setTimeout(() => {
          box.remove();
        }, 4000);
      }
      
    }

    function buttonClicked() {
      if (playImage.getAttribute("src").split("/").slice(-1)[0] == "playIcon.png") {
        if (audioPlayer.getAttribute("src") == "" || audioPlayer.getAttribute("src") == null) {
           showError("No track selected")
        } else {
          playImage.setAttribute("src", "assets/graphics/pauseIcon.png");
          audioPlayer.play();
        }

      } else {
        playImage.setAttribute("src", "assets/graphics/playIcon.png");
        audioPlayer.pause();

      }
    }

    function tracker_changed() {
      audioPlayer.currentTime = 40;
    }

    // document.getElementById("crushForm").addEventListener("submit", async function(e) {
    //   e.preventDefault();
    //   const form = e.target;
    //   const formData = new FormData(form);
    //   const messageEl = document.getElementById("message");

    //   try {
    //     const response = await fetch("https://anonomouscrush.onrender.com/submit", { method: "POST", body: formData });

    //     if (!response.ok) {
    //       let errMsg = "Unknown error";
    //       try {
    //         const err = await response.json();
    //         errMsg = err.error || errMsg;
    //       } catch {}
    //       throw new Error(errMsg);
    //     }

    //     const result = await response.json();
    //     messageEl.style.color = result.match ? "green" : "black";
    //     messageEl.textContent = result.match
    //       ? "ðŸŽ‰ You have a match! Check your email."
    //       : "âœ… Submission saved!";
    //     form.reset();
    //   } catch (error) {
    //     messageEl.style.color = "red";
    //     messageEl.textContent = `Error: ${error.message}`;
    //   }
    // });
  </script>
</body>
</html>
